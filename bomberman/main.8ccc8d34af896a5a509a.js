(()=>{"use strict";var e,t={622:(e,t,i)=>{var r=i(976),s=i(766);const l=JSON.parse('{"frames":{"explosion_02.png":{"frame":{"x":0,"y":0,"w":32,"h":32},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":32,"h":32},"sourceSize":{"w":32,"h":32}},"explosion_03.png":{"frame":{"x":32,"y":0,"w":32,"h":32},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":32,"h":32},"sourceSize":{"w":32,"h":32}},"explosion_04.png":{"frame":{"x":64,"y":0,"w":32,"h":32},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":32,"h":32},"sourceSize":{"w":32,"h":32}},"explosion_05.png":{"frame":{"x":96,"y":0,"w":32,"h":32},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":32,"h":32},"sourceSize":{"w":32,"h":32}},"explosion_06.png":{"frame":{"x":128,"y":0,"w":32,"h":32},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":32,"h":32},"sourceSize":{"w":32,"h":32}},"explosion_07.png":{"frame":{"x":160,"y":0,"w":32,"h":32},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":32,"h":32},"sourceSize":{"w":32,"h":32}},"explosion_08.png":{"frame":{"x":192,"y":0,"w":32,"h":32},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":32,"h":32},"sourceSize":{"w":32,"h":32}},"explosion_09.png":{"frame":{"x":224,"y":0,"w":32,"h":32},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":32,"h":32},"sourceSize":{"w":32,"h":32}},"explosion_10.png":{"frame":{"x":256,"y":0,"w":32,"h":32},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":32,"h":32},"sourceSize":{"w":32,"h":32}},"explosion_11.png":{"frame":{"x":288,"y":0,"w":32,"h":32},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":32,"h":32},"sourceSize":{"w":32,"h":32}}},"animations":{"explosion":["explosion_02.png","explosion_03.png","explosion_04.png","explosion_05.png","explosion_06.png","explosion_07.png","explosion_08.png","explosion_09.png","explosion_10.png","explosion_11.png"]},"meta":{"app":"https://www.codeandweb.com/texturepacker","version":"1.0","image":"explosion.png","format":"RGBA8888","size":{"w":320,"h":32},"scale":"1","smartupdate":"$TexturePacker:SmartUpdate:72cb6e8ee97d5c9b0045ad0ed16ce3d8:2dc2dff98fa0ea951445309b4aedcd20:900e1fb3093a9a6ecb2b2b49071c44f7$"}}'),a=i.p+"057682fc399038ac7419b5f42703606b.png",o=JSON.parse('{"frames":{"c2_down_1":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":0,"y":0,"w":64,"h":64}},"c2_down_2":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":64,"y":0,"w":64,"h":64}},"c2_down_3":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":128,"y":0,"w":64,"h":64}},"c2_down_4":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":192,"y":0,"w":64,"h":64}},"c2_left_1":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":0,"y":64,"w":64,"h":64}},"c2_left_2":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":64,"y":64,"w":64,"h":64}},"c2_left_3":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":128,"y":64,"w":64,"h":64}},"c2_left_4":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":192,"y":64,"w":64,"h":64}},"c2_right_1":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":0,"y":128,"w":64,"h":64}},"c2_right_2":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":64,"y":128,"w":64,"h":64}},"c2_right_3":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":128,"y":128,"w":64,"h":64}},"c2_right_4":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":192,"y":128,"w":64,"h":64}},"c2_up_1":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":0,"y":192,"w":64,"h":64}},"c2_up_2":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":64,"y":192,"w":64,"h":64}},"c2_up_3":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":128,"y":192,"w":64,"h":64}},"c2_up_4":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":192,"y":192,"w":64,"h":64}}},"animations":{"down":["c2_down_1","c2_down_2","c2_down_3","c2_down_4"],"left":["c2_left_1","c2_left_2","c2_left_3","c2_left_4"],"right":["c2_right_1","c2_right_2","c2_right_3","c2_right_4"],"up":["c2_up_1","c2_up_2","c2_up_3","c2_up_4"]},"meta":{"version":"1.0","image":"2.png","format":"RGBA8888","size":{"w":256,"h":256},"scale":"1"}}'),n=i.p+"8deec16cad03004b99981c378a0a898b.png",c=JSON.parse('{"frames":{"c1_down_1":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":0,"y":0,"w":64,"h":64}},"c1_down_2":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":64,"y":0,"w":64,"h":64}},"c1_down_3":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":128,"y":0,"w":64,"h":64}},"c1_down_4":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":192,"y":0,"w":64,"h":64}},"c1_left_1":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":0,"y":64,"w":64,"h":64}},"c1_left_2":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":64,"y":64,"w":64,"h":64}},"c1_left_3":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":128,"y":64,"w":64,"h":64}},"c1_left_4":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":192,"y":64,"w":64,"h":64}},"c1_right_1":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":0,"y":128,"w":64,"h":64}},"c1_right_2":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":64,"y":128,"w":64,"h":64}},"c1_right_3":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":128,"y":128,"w":64,"h":64}},"c1_right_4":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":192,"y":128,"w":64,"h":64}},"c1_up_1":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":0,"y":192,"w":64,"h":64}},"c1_up_2":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":64,"y":192,"w":64,"h":64}},"c1_up_3":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":128,"y":192,"w":64,"h":64}},"c1_up_4":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":192,"y":192,"w":64,"h":64}}},"animations":{"down":["c1_down_1","c1_down_2","c1_down_3","c1_down_4"],"left":["c1_left_1","c1_left_2","c1_left_3","c1_left_4"],"right":["c1_right_1","c1_right_2","c1_right_3","c1_right_4"],"up":["c1_up_1","c1_up_2","c1_up_3","c1_up_4"]},"meta":{"version":"1.0","image":"2.png","format":"RGBA8888","size":{"w":256,"h":256},"scale":"1"}}'),h=i.p+"a7be95275879fa93afc01db72b8a7cd8.png",d=JSON.parse('{"frames":{"c3_down_1":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":0,"y":0,"w":64,"h":64}},"c3_down_2":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":64,"y":0,"w":64,"h":64}},"c3_down_3":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":128,"y":0,"w":64,"h":64}},"c3_down_4":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":192,"y":0,"w":64,"h":64}},"c3_left_1":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":0,"y":64,"w":64,"h":64}},"c3_left_2":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":64,"y":64,"w":64,"h":64}},"c3_left_3":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":128,"y":64,"w":64,"h":64}},"c3_left_4":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":192,"y":64,"w":64,"h":64}},"c3_right_1":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":0,"y":128,"w":64,"h":64}},"c3_right_2":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":64,"y":128,"w":64,"h":64}},"c3_right_3":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":128,"y":128,"w":64,"h":64}},"c3_right_4":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":192,"y":128,"w":64,"h":64}},"c3_up_1":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":0,"y":192,"w":64,"h":64}},"c3_up_2":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":64,"y":192,"w":64,"h":64}},"c3_up_3":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":128,"y":192,"w":64,"h":64}},"c3_up_4":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":192,"y":192,"w":64,"h":64}}},"animations":{"down":["c3_down_1","c3_down_2","c3_down_3","c3_down_4"],"left":["c3_left_1","c3_left_2","c3_left_3","c3_left_4"],"right":["c3_right_1","c3_right_2","c3_right_3","c3_right_4"],"up":["c3_up_1","c3_up_2","c3_up_3","c3_up_4"]},"meta":{"version":"1.0","image":"2.png","format":"RGBA8888","size":{"w":256,"h":256},"scale":"1"}}'),u=i.p+"408dfe70ac698681775baf57388b78fd.png",b=JSON.parse('{"frames":{"c4_down_1":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":0,"y":0,"w":64,"h":64}},"c4_down_2":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":64,"y":0,"w":64,"h":64}},"c4_down_3":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":128,"y":0,"w":64,"h":64}},"c4_down_4":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":192,"y":0,"w":64,"h":64}},"c4_left_1":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":0,"y":64,"w":64,"h":64}},"c4_left_2":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":64,"y":64,"w":64,"h":64}},"c4_left_3":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":128,"y":64,"w":64,"h":64}},"c4_left_4":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":192,"y":64,"w":64,"h":64}},"c4_right_1":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":0,"y":128,"w":64,"h":64}},"c4_right_2":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":64,"y":128,"w":64,"h":64}},"c4_right_3":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":128,"y":128,"w":64,"h":64}},"c4_right_4":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":192,"y":128,"w":64,"h":64}},"c4_up_1":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":0,"y":192,"w":64,"h":64}},"c4_up_2":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":64,"y":192,"w":64,"h":64}},"c4_up_3":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":128,"y":192,"w":64,"h":64}},"c4_up_4":{"rotated":false,"trimmed":false,"sourceSize":{"w":64,"h":64},"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"frame":{"x":192,"y":192,"w":64,"h":64}}},"animations":{"down":["c4_down_1","c4_down_2","c4_down_3","c4_down_4"],"left":["c4_left_1","c4_left_2","c4_left_3","c4_left_4"],"right":["c4_right_1","c4_right_2","c4_right_3","c4_right_4"],"up":["c4_up_1","c4_up_2","c4_up_3","c4_up_4"]},"meta":{"version":"1.0","image":"2.png","format":"RGBA8888","size":{"w":256,"h":256},"scale":"1"}}'),f=i.p+"5ae9676190faeff7d1b5fb9037c18d8a.png",p=i.p+"5e9a557e230fc03e88e5f8d97de4fb6a.png",w=i.p+"3f248baa3f7a341cae5c25e4718fcde1.png",m=i.p+"90a8535477d59addf1e457000885cc5f.png",y=i.p+"5ab9a45fc3f389be3f7071d5c10f6185.png",g=i.p+"996b3e4d464f9c36c9b06962f3a4aa13.png",x=i.p+"3b183f8dd01687003b2325e78f0ee576.png",_=i.p+"4c31285cd11148351a15b77bf9d6b88b.png",v=i.p+"9502a42fce8a597345858a9e69a2eac4.png",S=i.p+"c36199cff4e4bd64cc3bc7490e686c78.png",C=i.p+"a7d092b49f3190fd96914512b37b43ba.png",z=e=>r.xEZ.from(e,{scaleMode:r.aH$.NEAREST}),k=async(e,t)=>{const i=new r.c2G(r.xEZ.from(e,{scaleMode:r.aH$.NEAREST}),t);return await new Promise((e=>{i.parse((()=>e(i)))}))};class O{static async initialize(){this.GRASS_TEXTURE=z(p),this.WALL_TEXTURE=z(w),this.WOOD_TEXTURE=z(m),this.STONE_TEXTURE=z(y),this.BRICK_TEXTURE=z(g),this.DYNAMITE_TEXTURE=z(x),this.TIMEBOMB_TEXTURE=z(_),this.BOMB_TEXTURE=z(v),this.TOMBSTONE_TEXTURE=z(S),this.SHIELD_TEXTURE=z(C),this.EXPLOSION_SPRITESHEET=await k(a,l),this.CHARACTER_1=await k(n,o),this.CHARACTER_2=await k(h,c),this.CHARACTER_3=await k(u,d),this.CHARACTER_4=await k(f,b)}}var A=i(729),P=i.n(A);class R{constructor(e,t){Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.x=e,this.y=t}}class j{constructor(e,t){Object.defineProperty(this,"p1",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"p2",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.p1=e,this.p2=t}get x0(){return this.p1.x}get y0(){return this.p1.y}get x1(){return this.p2.x}get y1(){return this.p2.y}get cx(){return(this.x0+this.x1)/2}get cy(){return(this.y0+this.y1)/2}shift(e,t){const{x0:i,y0:r,x1:s,y1:l}=this;return j.fromCoords(i+e,r+t,s+e,l+t)}shiftX(e){const{x0:t,y0:i,x1:r,y1:s}=this;return j.fromCoords(t+e,i,r+e,s)}shiftY(e){const{x0:t,y0:i,x1:r,y1:s}=this;return j.fromCoords(t,i+e,r,s+e)}testCollision(e){return!(this.p1.x>e.p2.x||e.p1.x>this.p2.x||this.p2.y>e.p1.y||e.p2.y>this.p1.y)}getIntersection(e){const t=Math.max(this.x0,e.x0),i=Math.max(this.y0,e.y0);return[Math.min(this.x1,e.x1)-t,Math.min(this.y1,e.y1)-i]}static fromCoords(e,t,i,r){return new j(new R(e,t),new R(i,r))}static fromDims(e,t,i,r){return new j(new R(e,t),new R(e+i,t+r))}}class M{constructor(e){Object.defineProperty(this,"context",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"emitter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.context=e,this.emitter=new(P()),this.container=new r.W20,this.container.width=e.cellSize,this.container.height=e.cellSize}get bbox(){const{x:e,y:t,width:i,height:r}=this.renderable;return j.fromDims(e,t,i,r)}on(e,t){this.emitter.on(e+"",t)}off(e,t){this.emitter.off(e+"",t)}get renderable(){return this.container}}class E extends M{}class T extends E{constructor(){super(...arguments),Object.defineProperty(this,"sprite",{enumerable:!0,configurable:!0,writable:!0,value:r.jyi.from(O.GRASS_TEXTURE)})}get isWall(){return!1}get isDestroyable(){return!1}get renderable(){return this.sprite}}class D{constructor(e,t,i,r){Object.defineProperty(this,"board",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"col",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"row",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_block",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.board=r,this.col=e,this.row=t,this._block=i}get renderable(){return this._block.renderable}get bbox(){return this._block.bbox}get hash(){return this.col+"#"+this.row}get isWall(){return this._block.isWall}get isDestroyable(){return this._block.isDestroyable}get block(){return this._block}set block(e){e!==this._block&&(this._block&&this._block.renderable.destroy(),e||(e=new T(this.board.context)),e.renderable.x=this.col*this.board.cellSize,e.renderable.y=this.row*this.board.cellSize,e.renderable.width=this.board.cellSize,e.renderable.height=this.board.cellSize,this._block=e,this.board.renderable.addChild(this._block.renderable))}get nCell(){return this.board.getCellAt(this.col-0,this.row-1)}get nwCell(){return this.board.getCellAt(this.col-1,this.row-1)}get wCell(){return this.board.getCellAt(this.col-1,this.row-0)}get swCell(){return this.board.getCellAt(this.col-1,this.row+1)}get sCell(){return this.board.getCellAt(this.col-0,this.row+1)}get seCell(){return this.board.getCellAt(this.col+1,this.row+1)}get eCell(){return this.board.getCellAt(this.col+1,this.row+0)}get neCell(){return this.board.getCellAt(this.col+1,this.row-1)}getNeighbors(e=!0){const t=[this.nCell,this.wCell,this.sCell,this.eCell];return e&&t.push(this.nwCell,this.swCell,this.seCell,this.neCell),t.filter((e=>!!e))}setAsDefault(){this.block=null}getDistance(e){const t=this.bbox,i=e.bbox,r=i.cx-t.cx,s=i.cy-t.cy;return Math.sqrt(r**2+s**2)/this.board.cellSize}alignObject(e){const t=this.board.cellSize,i=this.col*t,r=this.row*t,s=e.width,l=e.height;e.x=i+(t-s)/2,e.y=r+(t-l)/2}}var L=i(582),B=i.n(L);class H{constructor(e,t){Object.defineProperty(this,"cellsTree",{enumerable:!0,configurable:!0,writable:!0,value:new W}),Object.defineProperty(this,"cellsMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"onCellAddListener",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onCellRemoveListener",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.onCellAddListener=e,this.onCellRemoveListener=t}testCollision(e){return!!this.findIntersection(e).find((t=>{if(t.isWall){const[i,r]=e.getIntersection(t.bbox);return i>.01&&r>.01}return!1}))}findIntersection(e){const{x0:t,y0:i,x1:r,y1:s}=e;return this.cellsTree.search({minX:t,minY:i,maxX:r,maxY:s})}getCellAt(e,t){return this.cellsMap.get(this.getMapKey(e,t))}addCell(e){const{row:t,col:i}=e,r=this.getMapKey(i,t);if(this.cellsMap.has(r)){const e=this.cellsMap.get(r);this.cellsTree.remove(e),this.onCellRemoveListener(e)}this.cellsMap.set(r,e),this.cellsTree.insert(e),this.onCellAddListener(e)}getNonWallCells(){return[...this.cellsMap.values()].filter((e=>!e.isWall))}getRandomNonWallCell(){const e=this.getNonWallCells();return e[Math.floor(Math.random()*e.length)]}getMapKey(e,t){return e+"#"+t}}class W extends(B()){toBBox(e){const{x0:t,y0:i,x1:r,y1:s}=e.bbox;return{minX:t,minY:i,maxX:r,maxY:s}}compareMinX(e,t){return e.bbox.p1.x-t.bbox.p1.x}compareMinY(e,t){return e.bbox.p2.x-t.bbox.p2.x}}var N=i(485),F=i.n(N);class U{find(e,t){const i=new(F())(((e,t)=>e.fscore-t.fscore)),r=new Map,s=new X(e);for(s.gscore=0,s.fscore=0,s.opened=!0,i.push(s),r.set(s.cell.hash,s);!i.empty();){const e=i.pop();if(e.closed=!0,e.cell==t){const t=e.backtrace();return new I(t.map((e=>e.cell)))}e.cell.getNeighbors().forEach((s=>{var l;const a=null!==(l=r.get(s.hash))&&void 0!==l?l:new X(s);if(r.has(s.hash)||r.set(s.hash,a),a.closed||s.isWall)return;const o=e.cell.col,n=e.cell.row,c=s.col,h=s.row,d=c-o==0||h-n==0?1:Math.SQRT2,u=e.gscore+d;(!a.opened||u<a.gscore)&&(a.gscore=u,a.fscore=u+this.heuristic(s,t),a.parent=e,a.opened?i.updateItem(a):(i.push(a),a.opened=!0))}))}return null}heuristic(e,t){return Math.abs(t.col-e.col)+Math.abs(t.row-e.row)}}class X{constructor(e){Object.defineProperty(this,"cell",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"opened",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"closed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"gscore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fscore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cell=e}backtrace(){const e=[this];let t=this.parent;for(;t;)e.push(t),t=t.parent;return e.reverse()}}class I{constructor(e){Object.defineProperty(this,"cells",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"points",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cells=e,this.points=this.getPoints(e)}getPoints(e){const t=[...e],i=[t[0]];for(let e=1;e<t.length-1;e++){const r=t[e-1],s=t[e+0],l=t[e+1],a=1==Math.abs(s.col-r.col),o=1==Math.abs(s.row-r.row),n=1==Math.abs(l.col-s.col),c=1==Math.abs(l.row-s.row);(a&&c||n&&o)&&i.push(s)}return i.push(t.pop()),i}}class V{constructor(e){Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cells",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"context",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"pathFinder",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cellSize",{enumerable:!0,configurable:!0,writable:!0,value:42}),this.context=e,this.pathFinder=new U,this.container=new r.W20,this.cells=new H((e=>this.container.addChild(e.renderable)),(e=>this.container.removeChild(e.renderable)))}get renderable(){return this.container}testCollision(e){return this.cells.testCollision(e)}getCellAt(e,t){return this.cells.getCellAt(e,t)}addCell(e,t,i){const r=new D(e,t,i,this);return r.block.renderable.x=e*this.cellSize,r.block.renderable.y=t*this.cellSize,r.block.renderable.width=this.cellSize,r.block.renderable.height=this.cellSize,this.container.addChild(r.block.renderable),this.cells.addCell(r),r}getNonWallCells(){return this.cells.getNonWallCells()}getRandomNonWallCell(){return this.cells.getRandomNonWallCell()}}class K extends r.W20{constructor(e){super(),Object.defineProperty(this,"cellSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cellSize=e,this.width=e,this.height=e,this.sortableChildren=!0}addAndFill(e){return e.width=this.cellSize,e.height=this.cellSize,this.addChild(e),this}addAndCenter(e){const t=this.cellSize,i=this.x,r=this.y,s=e.width,l=e.height;return e.x=i+(t-s)/2,e.y=r+(t-l)/2,this.addChild(e),this}align(e){return e.alignObject(this),this}}class Y extends K{constructor(e,t){super(e),Object.defineProperty(this,"spritesheet",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sprite",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.spritesheet=t,this.sprite=new r.KgH(t.animations.down),this.sprite.animationSpeed=.1,this.addAndFill(this.sprite)}setDirection(e,t){e>0?this.direction="right":e<0&&(this.direction="left"),t>0?this.direction="down":t<0&&(this.direction="up")}set direction(e){switch(e){case"up":this.setAnimation("up");break;case"down":this.setAnimation("down");break;case"left":this.setAnimation("left");break;case"right":this.setAnimation("right")}}play(){this.sprite.play()}stop(){this.sprite.stop()}setAnimation(e){const t=this.spritesheet.animations[e];this.sprite.textures!=t&&(this.sprite.textures=t)}}var G=i(906);class $ extends K{constructor(e){super(e),Object.defineProperty(this,"frame",{enumerable:!0,configurable:!0,writable:!0,value:new r.TCu}),this.frame.beginFill(28671).drawRect(0,0,e,e).beginFill(5018608).drawRect(3,3,e-6,e-6),this.addAndFill(this.frame)}}const J=i.p+"93491352f66bda28cd281f1a82f150f4.mp3";class q extends E{constructor(e){super(e),Object.defineProperty(this,"sprite",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.sprite=new $(e.cellSize)}get isWall(){return!1}get isDestroyable(){return!1}get renderable(){return this.sprite}playCollectSound(){new s.Howl({src:[J],volume:.1,autoplay:!0})}setFrameRenderable(e){e.width=3*this.context.cellSize/4,e.height=3*this.context.cellSize/4,this.sprite.addAndCenter(e)}}class Z extends K{constructor(e){super(e),this.addAndFill(r.jyi.from(O.SHIELD_TEXTURE))}}class Q extends K{constructor(e){super(e),this.addAndFill(r.jyi.from(O.TOMBSTONE_TEXTURE))}}var ee=i(73);const te=i.p+"75f75e3a6a213d414186426ecb89d55a.mp3";class ie extends r.KgH{constructor(e){super(O.EXPLOSION_SPRITESHEET.animations.explosion),this.width=e,this.height=e,this.animationSpeed=.3,this.loop=!1,this.play()}}class re extends K{constructor(e){super(e),Object.defineProperty(this,"timer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.timer=new se,this.timer.renderable.zIndex=999;const{width:t,height:i}=this.timer.renderable;this.addChild(this.timer.renderable),this.timer.renderable.x=e-t,this.timer.renderable.y=e-i}set timerValue(e){this.timer.value=e}}class se{constructor(){Object.defineProperty(this,"circle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"textStyle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.circle=(new r.TCu).beginFill(0).lineStyle(1,16777215).drawCircle(8,8,8),this.circle.visible=!1,this.textStyle=new r.pn8({fontFamily:"Pixeboy",fontSize:16,fill:"#fff"})}get renderable(){return this.circle}set value(e){if(e<0)return void(this.circle.visible=!1);this.circle.visible=!0,this.circle.removeChildren();const t=new r.xvT(e+"",this.textStyle);t.anchor.set(-.5,0),this.circle.addChild(t)}}const le=async function(e,t){let i;return i=t?Math.random()*(t-e)+e:e,await new Promise((e=>{setTimeout((()=>e()),i)}))};class ae{constructor(e){Object.defineProperty(this,"context",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.context=e}}class oe extends ae{constructor(){super(...arguments),Object.defineProperty(this,"delay",{enumerable:!0,configurable:!0,writable:!0,value:1500})}async spawnAt(e,t){const{app:i,board:l,cellSize:a,ticker:o,actors:n}=this.context,{stage:c}=i,h=new re(a);h.addAndFill(r.jyi.from(O.DYNAMITE_TEXTURE)),h.align(e),c.addChild(h);const d=this.delay/3;for(let e=0;e<3;e++)h.timerValue=3-e,await le(d);h.destroy();const u=[],b=new ee.f([(e.col+.5)*a,(e.row+.5)*a],{radius:100,amplitude:15,brightness:1.2});c.filters?c.filters.push(b):c.filters=[b];const f=()=>b.time+=.01;o.add(f),new s.Howl({src:[te],volume:.25,autoplay:!0});const{col:p,row:w}=e;let m=!0,y=!0,g=!0,x=!0;const _=e=>{if(e){if(e.isDestroyable)return e.setAsDefault(),!1;if(e.isWall)return!1;{const t=new ie(a);u.push(t),e.alignObject(t),c.addChild(t);const{x:i,y:r,width:s,height:l}=t,o=j.fromDims(i,r,s,l);n.forEach((e=>{const[t,i]=e.bbox.getIntersection(o);t>.01&&i>.01&&(e.health-=20)}))}return!0}return!1};for(let e=0;e<5;e++){const t=g?l.getCellAt(p-0,w-e):null,i=y?l.getCellAt(p-e,w-0):null,r=m?l.getCellAt(p+0,w+e):null,s=x?l.getCellAt(p+e,w+0):null;g=_(t),y=_(i),m=_(r),x=_(s),await le(200)}await le(500),u.forEach((e=>e.destroy())),o.remove(f),c.filters.splice(c.filters.indexOf(b),1)}getRenderable(){return new re(this.context.cellSize).addAndFill(r.jyi.from(O.DYNAMITE_TEXTURE))}}class ne{constructor(e){Object.defineProperty(this,"outerBar",{enumerable:!0,configurable:!0,writable:!0,value:new r.TCu}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.size=e-8,this.outerBar.y=4,this.outerBar.x=4,this.setHealth(1,1)}get renderable(){return this.outerBar}setHealth(e,t){this.outerBar.beginFill(0),this.outerBar.drawRect(0,0,this.size,3);const i=e/t;this.outerBar.beginFill(this.getBarColor(i)),this.outerBar.drawRect(0,0,i*this.size,3)}getBarColor(e){return(255*(1-e)<<16)+(255*e<<8)+0}}class ce{constructor(e){Object.defineProperty(this,"defaultWeaponProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stack",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.defaultWeaponProvider=e}push(e){this.stack.push(e)}pop(){return 0==this.stack.length?this.defaultWeaponProvider():this.stack.pop()}}class he extends M{constructor(e){super(e),Object.defineProperty(this,"_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"currentCell",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"healthBar",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shieldSprite",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_speed",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"_maxHealth",{enumerable:!0,configurable:!0,writable:!0,value:150}),Object.defineProperty(this,"_health",{enumerable:!0,configurable:!0,writable:!0,value:this._maxHealth}),Object.defineProperty(this,"_isMoving",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_hasShield",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_weaponStack",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.healthBar=new ne(e.cellSize),this.shieldSprite=new Z(e.cellSize),this.shieldSprite.visible=!1,this.shieldSprite.zIndex=1,this.healthBar.renderable.zIndex=2,this.container.addChild(this.healthBar.renderable),this.container.addChild(this.shieldSprite),this._id="actor_"+he.actorCounter,he.actorCounter++,this._weaponStack=new ce((()=>new oe(e))),this.on("healthchange",(e=>{this.healthBar.setHealth(e,this.maxHealth)})),this.on("die",(()=>{e.player.isAlive?e.enemies.every((e=>!e.isAlive))&&e.playerWin():e.playerLose(),this.container.removeChildren(),this.container.addChild(new Q(e.cellSize))}))}get id(){return this._id}get speed(){return this._speed}set speed(e){this._speed=Math.max(e,0)}get health(){return this._health}set health(e){const t=this._health,i=Math.min(Math.max(e,0),this.maxHealth);if(t!=i){if(this._hasShield&&i<t)return;this._health=i,this.emitter.emit("healthchange",this._health),0==this._health&&this.emitter.emit("die")}}get isMoving(){return this._isMoving}get isAlive(){return this._health>0}get weaponStack(){return this._weaponStack}get nearestCell(){const e=this.context.board,t=e.cellSize,{cx:i,cy:r}=this.bbox;return e.getCellAt(Math.floor(i/t),Math.floor(r/t))}get maxHealth(){return this._maxHealth}get hasShield(){return this._hasShield}set hasShield(e){this._hasShield=e,this.shieldSprite.visible=e}instantKill(){this.health=0}spawnAt(e,t){"number"==typeof e?this.moveToCell(e,t):this.moveToCell(e),this.context.addObject(this),this.emitter.emit("spawn",this.nearestCell)}moveToCell(e,t){let i;i="number"==typeof e?this.context.board.getCellAt(e,t):e,i.isWall||i.alignObject(this.renderable)}move(e,t){const i=this.context.board,r=this.bbox;let s=!1;if(this.nearestCell!=this.currentCell&&(this.emitter.emit("cellchange",this.nearestCell,this.currentCell),this.currentCell=this.nearestCell,this.currentCell.block instanceof q&&this.currentCell.block.onCollect(this,this.currentCell)),0!=e){const t=r.shiftX(e);if(i.testCollision(t)){let t,i;s=!0,e>0?(t=this.bbox.x1,i=this.nearestCell.eCell.bbox.x0):(t=this.bbox.x0,i=this.nearestCell.wCell.bbox.x1),e=i-t}}if(0!=t){const e=r.shiftY(t);if(i.testCollision(e)){let e,i;s=!0,t>0?(e=this.bbox.y1,i=this.nearestCell.sCell.bbox.y0):(e=this.bbox.y0,i=this.nearestCell.nCell.bbox.y1),t=i-e}}return 0!=e||0!=t?(this.renderable.x+=e,this.renderable.y+=t,this._isMoving=!0,this.emitter.emit("move",e,t)):(this._isMoving=!1,this.emitter.emit("idle")),s}}Object.defineProperty(he,"actorCounter",{enumerable:!0,configurable:!0,writable:!0,value:0});class de extends he{constructor(e){super(e),Object.defineProperty(this,"sprite",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"isDownW",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isDownS",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isDownA",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isDownD",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lastDeeployTime",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.sprite=new Y(e.cellSize,O.CHARACTER_1),this.sprite.filters=[new G.r(1)],this.container.addChild(this.sprite),this.on("spawn",(()=>{this.addKeyObserver("w",(e=>this.isDownW=e)),this.addKeyObserver("s",(e=>this.isDownS=e)),this.addKeyObserver("a",(e=>this.isDownA=e)),this.addKeyObserver("d",(e=>this.isDownD=e)),document.addEventListener("keypress",(e=>{" "===e.key&&this.deployWeapon()}));const{ticker:t}=e;t.add((t=>{if(e.isDestroyed)return;const i=t*this.speed;let r=(-1*+this.isDownA+1*+this.isDownD)*i,s=(-1*+this.isDownW+1*+this.isDownS)*i;if(0==r&&0==s)return void this.emitter.emit("idle");const l=Math.sign(r),a=Math.sign(s);if(0!=r&&0!=s&&(r=l*i/Math.sqrt(2),s=a*i/Math.sqrt(2)),this.move(r,s)&&(0==r||0==s))if(0!=r){const e=this.nearestCell,t=this.bbox,s=this.nearestCell.bbox;if(r<0&&e.wCell.isWall||r>0&&e.eCell.isWall)return;const l=t.cy,a=s.cy-l;Math.abs(i)>Math.abs(a)?this.move(0,a):this.move(0,Math.sign(a)*i)}else{const e=this.nearestCell,t=this.bbox,r=this.nearestCell.bbox;if(s<0&&e.nCell.isWall||s>0&&e.sCell.isWall)return;const l=t.cx,a=r.cx-l;Math.abs(i)>Math.abs(a)?this.move(a,0):this.move(Math.sign(a)*i,0)}}))})),this.on("move",((e,t)=>{this.sprite.setDirection(e,t),this.sprite.play()})),this.on("idle",(()=>{this.sprite.stop()}))}deployWeapon(){const e=(new Date).getTime();e-this.lastDeeployTime<1e3||(this.lastDeeployTime=e,this.weaponStack.pop().spawnAt(this.nearestCell,this))}addKeyObserver(e,t){document.addEventListener("keydown",(i=>{i.key===e&&t(!0)})),document.addEventListener("keyup",(i=>{i.key===e&&t(!1)}))}}const ue=i.p+"ccf03cfd6ce7a452e126c0b6568aeac4.mp3",be=i.p+"882119d2a36ddba22c9aee02939b8b81.mp3";class fe{constructor(e,t){Object.defineProperty(this,"emmiter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"actor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_src",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dest",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"path",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tickerCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_isRunning",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_isPaused",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.emmiter=new(P()),this.actor=e,this.dest=t;const i=e.context.board;this.path=i.pathFinder.find(this.actor.nearestCell,this.dest)}get isPossible(){return null!=this.path}on(e,t){this.emmiter.on(e+"",t)}off(e,t){this.emmiter.off(e+"",t)}start(){if(this._isRunning||!this.isPossible)return;this._src=this.actor.nearestCell;const{ticker:e}=this.actor.context,t=[...this.path.points],{cx:i,cy:r}=this.actor.bbox,{cx:s,cy:l}=t[1].bbox,a=Math.atan2(l-r,s-i)%(Math.PI/2);Math.abs(a)<.01&&t.shift();let o=this.getMovementData(this.actor.bbox,t.shift().bbox);this.tickerCallback=e=>{if(this._isPaused)return;const{cx:i,cy:r}=this.actor.bbox,{x1:s,y1:l,dirx:a,diry:n,cosa:c,sina:h}=o;let d,u;if(d=e*this.actor.speed*c,u=e*this.actor.speed*h,Math.abs(d)>Math.abs(s-i)&&(d=Math.abs(s-i)*a),Math.abs(u)>Math.abs(l-r)&&(u=Math.abs(l-r)*n),Math.abs(d)<=fe.epsilon&&(d=0),Math.abs(u)<=fe.epsilon&&(u=0),0==d&&0==u){this.actor.nearestCell.alignObject(this.actor.renderable);const e=t.shift();e?o=this.getMovementData(this.actor.nearestCell.bbox,e.bbox):this.finish()}else this.actor.move(d,u),this.emmiter.emit("change",d,u)},e.add(this.tickerCallback),this._isRunning=!0}get src(){return this._src}pause(){this._isPaused=!0}resume(){this._isPaused=!1}cancel(){this.actor.context.ticker.remove(this.tickerCallback),this.emmiter.emit("cancel")}finish(){this.actor.context.ticker.remove(this.tickerCallback),this.emmiter.emit("finish")}getMovementData(e,t){const i=t.cx-e.cx,r=t.cy-e.cy,s=Math.atan2(r,i);return{dx:i,dy:r,a:s,x0:e.cx,y0:e.cy,x1:t.cx,y1:t.cy,cosa:Math.round(Math.cos(s)),sina:Math.round(Math.sin(s)),dirx:Math.sign(i),diry:Math.sign(r)}}}Object.defineProperty(fe,"epsilon",{enumerable:!0,configurable:!0,writable:!0,value:.001});class pe extends he{constructor(){super(...arguments),Object.defineProperty(this,"currentMovement",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}goTo(e,t=!0,i=!0){let r;this.currentMovement&&this.currentMovement.cancel(),r="number"==typeof e?this.context.board.getCellAt(e,t):e;const s=new fe(this,r);return s.on("change",((e,t)=>this.emitter.emit("movement-change",e,t))),s.on("finish",(()=>{this._isMoving=!1,this.emitter.emit("movement-finish"),this.emitter.emit("idle")})),i&&s.start(),this.currentMovement=s,s}}class we{constructor(){Object.defineProperty(this,"emitter",{enumerable:!0,configurable:!0,writable:!0,value:new(P())}),Object.defineProperty(this,"_isDestroyed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_board",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_player",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_actors",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"app",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"backgroundMusic",{enumerable:!0,configurable:!0,writable:!0,value:new s.Howl({src:[ue],volume:.3,loop:!0,autoplay:!1})}),Object.defineProperty(this,"epicMusic",{enumerable:!0,configurable:!0,writable:!0,value:new s.Howl({src:[be],volume:.3,loop:!0,autoplay:!1})}),this.app=new r.MxU({backgroundColor:4013373}),this.reset()}on(e,t){this.emitter.on(e+"",t)}off(e,t){this.emitter.off(e+"",t)}playerWin(){this.emitter.emit("win")}playerLose(){this.emitter.emit("lose")}reset(){this.app.stage.removeChildren(),this._actors=[],this._board=new V(this),this.addObject(this._board),this._player=new de(this),this._actors.push(this._player)}get isDestroyed(){return this._isDestroyed}get ticker(){return this.app.ticker}get cellSize(){return this._board.cellSize}get stage(){return this.app.stage}get actors(){return this._actors}get enemies(){return this._actors.filter((e=>e instanceof pe))}get player(){return this._player}get board(){return this._board}getCellAt(e,t){return this._board.getCellAt(e,t)}addObject(e){e instanceof r.s$$?this.app.stage.addChild(e):e.renderable&&this.app.stage.addChild(e.renderable)}addActors(...e){this._actors.push(...e)}removeActors(...e){e.forEach((e=>{const t=this._actors.indexOf(e);t&&this._actors.splice(t,1)}))}resize(){const{app:e,board:t}=this;e.screen.width=t.renderable.width,e.screen.height=t.renderable.height,e.view.width=t.renderable.width,e.view.height=t.renderable.height}start(){this.ticker.start()}stop(){this.ticker.stop()}destroy(){this._isDestroyed=!0,this.epicMusic.stop(),this.backgroundMusic.stop()}}class me{constructor(){Object.defineProperty(this,"_context",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"root",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.P6Y.skipHello()}createContext(){this._context&&this._context.destroy();const e=new we;return this._context=e,this.root.replaceChildren(e.app.view),e}async initialize(){await O.initialize(),this.root=document.getElementById("canvas-wrapper")}}class ye extends pe{constructor(e){super(e),Object.defineProperty(this,"sprite",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.sprite=new Y(e.cellSize,O.CHARACTER_1),this.sprite.filters=[new G.r(1)],this.container.addChild(this.sprite);const{player:t,board:i}=e;let r;this.on("spawn",(async()=>{const t=e.player;for(;this.isAlive&&!e.isDestroyed;)this.nearestCell.getDistance(t.nearestCell)<=4&&(this.weaponStack.pop().spawnAt(this.nearestCell,this),r=this.goTo(i.getRandomNonWallCell()),await le(2500)),r=this.goTo(t.nearestCell),await le(1e3)})),this.on("move",((e,t)=>{this.sprite.setDirection(e,t),this.sprite.play()})),this.on("idle",(()=>this.sprite.stop())),this.on("die",(()=>null==r?void 0:r.cancel()))}}const ge=i.p+"9e89ce9ef9b3010cdde268e1b0370f36.mp3";class xe{static getOutline(e,t,i){let r=0,s=i,l=3-2*i;const a=[];for(;r<=s;)l<0?l+=4*r+2:(s-=1,l+=4*(r-s)+2),a.push([e+r,t+s]),a.push([e-r,t+s]),a.push([e+r,t-s]),a.push([e-r,t-s]),a.push([e+s,t+r]),a.push([e-s,t+r]),a.push([e+s,t-r]),a.push([e-s,t-r]),r+=1;return a}}class _e extends ae{constructor(e,t){var i,r,s,l;super(e),Object.defineProperty(this,"radius",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"delay",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"propagationDelay",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"destroyBricks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sprite",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.radius=null!==(i=null==t?void 0:t.radius)&&void 0!==i?i:2,this.delay=null!==(r=null==t?void 0:t.delay)&&void 0!==r?r:2e3,this.propagationDelay=null!==(s=null==t?void 0:t.propagationDelay)&&void 0!==s?s:100,this.destroyBricks=null===(l=null==t?void 0:t.destroyBricks)||void 0===l||l}async spawnAt(e,t){const{app:i,board:l,cellSize:a,ticker:o,actors:n}=this.context,{stage:c}=i,h=new re(a);if(h.addAndFill(r.jyi.from(O.BOMB_TEXTURE)),h.align(e),this.sprite=h,this.delay>0){c.addChild(h);const e=3,t=this.delay/e;for(let i=0;i<e;i++)h.timerValue=e-i,await le(t);h.destroy()}const d=[],u=new ee.f([(e.col+.5)*a,(e.row+.5)*a],{radius:200,amplitude:20,brightness:1.5});c.filters?c.filters.push(u):c.filters=[u];const b=()=>u.time+=.01;o.add(b),new s.Howl({src:[ge],volume:.1,autoplay:!0});for(let t=0;t<this.radius;t++)xe.getOutline(e.col,e.row,t+1).forEach((([e,t])=>{const i=l.getCellAt(e,t);if(!i)return;this.destroyBricks&&i.isDestroyable&&i.setAsDefault();const r=new ie(a);i.alignObject(r),c.addChild(r),d.push(r);const{x:s,y:o,width:h,height:u}=r,b=j.fromDims(s,o,h,u);n.forEach((e=>{const[t,i]=e.bbox.getIntersection(b);t>.01&&i>.01&&(e.health-=10)}))})),await le(this.propagationDelay);await le(500),d.forEach((e=>e.destroy())),o.remove(b),c.filters.splice(c.filters.indexOf(u),1)}getRenderable(){return new re(this.context.cellSize).addAndFill(r.jyi.from(O.BOMB_TEXTURE))}}const ve=i.p+"e4f5de6ededa448d3ed4482fe6e46cb1.mp3";class Se extends ae{constructor(e,t){var i;super(e),Object.defineProperty(this,"delay",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.delay=null!==(i=null==t?void 0:t.delay)&&void 0!==i?i:2e3}async spawnAt(e,t){const{app:i,cellSize:l,ticker:a,actors:o}=this.context,{stage:n}=i,c=new re(l);if(c.addAndFill(r.jyi.from(O.TIMEBOMB_TEXTURE)),c.align(e),this.delay>0){n.addChild(c);const e=3,t=this.delay/e;for(let i=0;i<e;i++)c.timerValue=e-i,await le(t);c.destroy()}const h=new ee.f([(e.col+.5)*l,(e.row+.5)*l],{radius:600,amplitude:15,brightness:1.5}),d=new r.u8d.ColorMatrixFilter;d.greyscale(1,!1),d.alpha=.3,n.filters?n.filters.push(h,d):n.filters=[h,d];let u=.002,b=.007;const f=()=>{h.time+=u;let e=d.alpha+b;e=Math.max(Math.min(.5,e),0),d.alpha=e};a.add(f),new s.Howl({src:[ve],volume:.5,autoplay:!0});const p=[];o.forEach((e=>{if(e!=t){const t=Math.max(Math.min(4,e.speed-1),0);p.push([e,t]),e.speed-=t}})),await le(3500),p.forEach((([e,t])=>{e.speed+=t})),u=.04,b=-.01,await le(1e3),a.remove(f),n.filters.splice(n.filters.indexOf(h),1),n.filters.splice(n.filters.indexOf(d),1)}getRenderable(){return new re(this.context.cellSize).addAndFill(r.jyi.from(O.TIMEBOMB_TEXTURE))}}class Ce{static getWeapon(e,t){switch(e){case"bomb":return new _e(t);case"dynamite":return new oe(t);case"timebomb":return new Se(t)}}static getRandom(e){const t=["bomb","timebomb"],i=Math.floor(Math.random()*t.length);return this.getWeapon(t[i],e)}}Object.defineProperty(Ce,"registeredWeapons",{enumerable:!0,configurable:!0,writable:!0,value:["bomb","dynamite","timebomb"]});const ze=i.p+"3dbb076ea1a6556b34895f3ea3e9ed1e.png";class ke extends q{constructor(e){super(e),this.setFrameRenderable(r.jyi.from(z(ze)))}onCollect(e,t){this.playCollectSound(),e.health+=40,t.setAsDefault()}}class Oe extends q{constructor(e){super(e),this.setFrameRenderable(r.jyi.from(z(C)))}onCollect(e,t){e.hasShield||(this.playCollectSound(),t.setAsDefault(),e.hasShield=!0,le(3500,7e3).then((()=>e.hasShield=!1)))}}const Ae=i.p+"3b66785776708d5a8787a1e37bc86624.png";class Pe extends q{constructor(e){super(e),this.setFrameRenderable(r.jyi.from(z(Ae)))}onCollect(e,t){this.playCollectSound(),e.speed+=1,t.setAsDefault(),le(1e4).then((()=>{e.context.isDestroyed||(e.speed-=1)}))}}class Re extends q{constructor(e,t){super(e),Object.defineProperty(this,"weapon",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.weapon=t,this.setFrameRenderable(this.weapon.getRenderable())}onCollect(e,t){this.playCollectSound(),t.setAsDefault(),e.weaponStack.push(this.weapon)}}class je{static getPowerUp(e,t){switch(e){case"health":return new ke(t);case"shield":return new Oe(t);case"speed":return new Pe(t);case"weapon":return new Re(t,Ce.getRandom(t))}}static getRandom(e){const t=Math.floor(Math.random()*je.registeredPowerUps.length);return this.getPowerUp(je.registeredPowerUps[t],e)}}Object.defineProperty(je,"registeredPowerUps",{enumerable:!0,configurable:!0,writable:!0,value:["health","speed","weapon","shield"]});class Me extends E{constructor(){super(...arguments),Object.defineProperty(this,"sprite",{enumerable:!0,configurable:!0,writable:!0,value:r.jyi.from(O.BRICK_TEXTURE)})}get isWall(){return!0}get isDestroyable(){return!0}get renderable(){return this.sprite}}class Ee extends E{constructor(){super(...arguments),Object.defineProperty(this,"sprite",{enumerable:!0,configurable:!0,writable:!0,value:r.jyi.from(O.WALL_TEXTURE)})}get isWall(){return!0}get isDestroyable(){return!1}get renderable(){return this.sprite}}class Te{constructor(e){Object.defineProperty(this,"context",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"blocks",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),this.context=e}fillCell(e,t,i){this.blocks.set(this.getCoordsHash(e,t),i)}fillRectangle(e,t,i,r,s){const l=Math.min(e,i),a=Math.min(t,r),o=Math.max(e,i),n=Math.max(t,r);for(let e=l;e<=o;e++)for(let t=a;t<=n;t++)this.blocks.set(this.getCoordsHash(e,t),s)}fillHorizontalLine(e,t,i,r){const s=Math.min(t,i),l=Math.max(t,i);for(let t=s;t<=l;t++)this.blocks.set(this.getCoordsHash(t,e),r)}fillVerticalLine(e,t,i,r){const s=Math.min(t,i),l=Math.max(t,i);for(let t=s;t<=l;t++)this.blocks.set(this.getCoordsHash(e,t),r)}build(){[...this.blocks.entries()].forEach((([e,t])=>{const i=e.split("#"),r=+i[0],s=+i[1],l=class{static getBlock(e,t){switch(e){case"grass":return new T(t);case"wall":return new Ee(t);case"bricks":return new Me(t)}}}.getBlock(t,this.context);this.context.board.addCell(r,s,l)})),this.blocks.clear()}getCoordsHash(e,t){return e+"#"+t}}class De{getName(){return"Level 1"}load(e){this.initBoard(e),e.resize()}start(e){e.player.spawnAt(1,1);const t=new ye(e);t.spawnAt(13,13),e.board.getCellAt(7,7).block=je.getPowerUp("speed",e),e.addActors(t),e.backgroundMusic.play(),(async()=>{for(;!e.isDestroyed;){await le(8e3);const t=e.board.getRandomNonWallCell(),i=je.getRandom(e);t.block=i}})()}initBoard(e){const t=new Te(e);t.fillRectangle(0,0,14,14,"wall"),t.fillRectangle(1,1,13,13,"grass"),t.fillRectangle(2,3,12,3,"wall"),t.fillRectangle(6,3,8,3,"bricks"),t.fillRectangle(3,2,3,12,"wall"),t.fillRectangle(3,6,3,8,"bricks"),t.fillRectangle(2,11,12,11,"wall"),t.fillRectangle(6,11,8,11,"bricks"),t.fillRectangle(11,2,11,12,"wall"),t.fillRectangle(11,6,11,8,"bricks"),t.fillCell(7,1,"wall"),t.fillCell(1,7,"wall"),t.fillCell(7,13,"wall"),t.fillCell(13,7,"wall"),t.fillVerticalLine(6,5,9,"wall"),t.fillVerticalLine(8,5,9,"wall"),t.fillHorizontalLine(6,5,9,"wall"),t.fillHorizontalLine(8,5,9,"wall"),t.fillVerticalLine(7,5,9,"bricks"),t.fillHorizontalLine(7,5,9,"bricks"),t.fillCell(7,7,"grass"),t.fillCell(2,2,"bricks"),t.fillCell(2,12,"bricks"),t.fillCell(12,2,"bricks"),t.fillCell(12,12,"bricks"),t.build()}}var Le=i(313);const Be=i.p+"191e262ce765190d1fb8331a20197253.mp3";class He extends pe{constructor(e){super(e),Object.defineProperty(this,"sprite",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.sprite=new Y(e.cellSize,O.CHARACTER_2),this.container.addChild(this.sprite);const t=new Le.R;t.kernelSize=15,this.sprite.filters=[t],this.speed=6;const i=new s.Howl({src:[Be],volume:.1,html5:!0});this.on("spawn",(()=>{const s=async()=>{if(!this.isAlive||e.isDestroyed)return;this.sprite.direction="down",this.sprite.play(),t.velocity=new r.E9j(0,0),await le(500,1500),i.play();const l=this.context.board.getRandomNonWallCell(),a=this.goTo(l,!1);a.isPossible||s(),a.on("finish",(()=>s())),a.on("change",(()=>{this.isAlive||a.cancel()})),a.start()};s();const l=async()=>{this.isAlive&&!e.isDestroyed&&(await le(2500,3e3),this.weaponStack.pop().spawnAt(this.nearestCell,this),l())};l()})),this.on("movement-change",((e,i)=>{t.velocity=new r.E9j(3*e,3*i)})),this.on("move",((e,t)=>{this.sprite.setDirection(e,t),this.sprite.play()})),this.on("idle",(()=>this.sprite.stop()))}}const We=async e=>{const{context:t,src:i,dest:r,bombDelay:s=3e3,throwTime:l=s}=e,{ticker:a}=t,{cx:o,cy:n}=i.bbox,{cx:c,cy:h}=r.bbox,d=new _e(t,{delay:s});d.spawnAt(r,void 0),i.alignObject(d.sprite);const u=(c-o)/l,b=(h-n)/l,f=()=>{const e=a.elapsedMS;d.sprite.destroyed||(d.sprite.x+=e*u,d.sprite.y+=e*b)};a.add(f),await le(l),setTimeout((()=>{a.remove(f)}),l)};class Ne extends pe{constructor(e,t){var i;super(e),Object.defineProperty(this,"sprite",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runAwayFromPlayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.sprite=new Y(e.cellSize,O.CHARACTER_3),this.sprite.filters=[new G.r(1)],this.container.addChild(this.sprite),this.speed=2.5,this._maxHealth=80,this.health=80,this.runAwayFromPlayer=null===(i=null==t?void 0:t.runAwayFromPlayer)||void 0===i||i,this.on("spawn",(()=>{if(this.runAwayFromPlayer){const t=async()=>{if(this.isAlive&&!e.isDestroyed)if(await le(500),this.isPlayerNearby()){const i=this.context.board.getRandomNonWallCell(),r=this.goTo(i,!1);r.isPossible||t(),r.on("finish",(()=>t())),r.on("change",(()=>{this.isAlive&&!e.isDestroyed||r.cancel()})),r.start()}else t()};t()}const t=async()=>{this.isAlive&&!e.isDestroyed&&(await le(1500,3e3),this.isMoving||(We({context:e,src:this.nearestCell,dest:e.player.nearestCell}),await le(500)),t())};t()})),this.on("move",((e,t)=>{this.sprite.setDirection(e,t),this.sprite.play()})),this.on("idle",(()=>{this.sprite.direction="down",this.sprite.stop()}))}isPlayerNearby(){const{player:e,cellSize:t}=this.context,{cx:i,cy:r}=e.bbox,{cx:s,cy:l}=this.bbox,a=Math.sqrt((s-i)**2+(l-r)**2);return Math.round(a/t)<4}}class Fe{getName(){return"Level 2"}load(e){this.initBoard(e),e.resize()}start(e){e.player.spawnAt(1,1);const t=new Ne(e);t.spawnAt(7,7);const i=new He(e);i.spawnAt(1,13);const r=new He(e);r.spawnAt(13,1);const s=new ye(e);s.spawnAt(13,13),e.addActors(t,i,r,s),e.backgroundMusic.play(),(async()=>{for(;!e.isDestroyed;){await le(8e3);const t=e.board.getRandomNonWallCell(),i=je.getRandom(e);t.block=i}})()}initBoard(e){const t=new Te(e);t.fillRectangle(0,0,14,14,"wall"),t.fillRectangle(1,1,13,13,"grass"),t.fillRectangle(2,3,12,3,"wall"),t.fillRectangle(6,3,8,3,"bricks"),t.fillRectangle(3,2,3,12,"wall"),t.fillRectangle(3,6,3,8,"bricks"),t.fillRectangle(2,11,12,11,"wall"),t.fillRectangle(6,11,8,11,"bricks"),t.fillRectangle(11,2,11,12,"wall"),t.fillRectangle(11,6,11,8,"bricks"),t.fillCell(7,1,"wall"),t.fillCell(1,7,"wall"),t.fillCell(7,13,"wall"),t.fillCell(13,7,"wall"),t.fillVerticalLine(6,5,9,"wall"),t.fillVerticalLine(8,5,9,"wall"),t.fillHorizontalLine(6,5,9,"wall"),t.fillHorizontalLine(8,5,9,"wall"),t.fillVerticalLine(7,5,9,"bricks"),t.fillHorizontalLine(7,5,9,"bricks"),t.fillCell(7,7,"grass"),t.fillCell(2,2,"bricks"),t.fillCell(2,12,"bricks"),t.fillCell(12,2,"bricks"),t.fillCell(12,12,"bricks"),t.build()}}class Ue{getName(){return"Level 3"}load(e){this.initBoard(e),e.resize()}start(e){e.player.spawnAt(7,7);const t=new Ne(e);t.spawnAt(1,1);const i=new Ne(e);i.spawnAt(1,13);const r=new Ne(e);r.spawnAt(13,13);const s=new Ne(e);s.spawnAt(13,1);const l=new He(e);l.spawnAt(3,7);const a=new He(e);a.spawnAt(7,3);const o=new He(e);o.spawnAt(7,11);const n=new He(e);n.spawnAt(11,7),e.addActors(t,i,r,s,l,a,o,n),e.backgroundMusic.play(),(async()=>{for(;!e.isDestroyed;){await le(8e3);const t=e.board.getRandomNonWallCell(),i=je.getRandom(e);t.block=i}})()}initBoard(e){const t=new Te(e);t.fillRectangle(0,0,14,14,"wall"),t.fillRectangle(1,1,13,13,"grass"),t.fillRectangle(1,1,3,3,"bricks"),t.fillCell(1,1,"grass"),t.fillCell(2,2,"wall"),t.fillCell(3,3,"wall"),t.fillRectangle(1,13,3,11,"bricks"),t.fillCell(1,13,"grass"),t.fillCell(2,12,"wall"),t.fillCell(3,11,"wall"),t.fillRectangle(13,13,11,11,"bricks"),t.fillCell(13,13,"grass"),t.fillCell(12,12,"wall"),t.fillCell(11,11,"wall"),t.fillRectangle(13,1,11,3,"bricks"),t.fillCell(13,1,"grass"),t.fillCell(12,2,"wall"),t.fillCell(11,3,"wall"),t.fillHorizontalLine(5,2,12,"wall"),t.fillHorizontalLine(9,2,12,"wall"),t.fillVerticalLine(9,2,12,"wall"),t.fillVerticalLine(5,2,12,"wall"),t.fillCell(7,5,"bricks"),t.fillCell(5,7,"bricks"),t.fillCell(7,9,"bricks"),t.fillCell(9,7,"bricks"),t.fillHorizontalLine(7,1,2,"bricks"),t.fillHorizontalLine(7,13,12,"bricks"),t.fillVerticalLine(7,1,2,"bricks"),t.fillVerticalLine(7,13,12,"bricks"),t.build()}}class Xe extends pe{constructor(e){super(e),Object.defineProperty(this,"sprite",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.sprite=new Y(e.cellSize,O.CHARACTER_4),this.container.addChild(this.sprite),this._maxHealth=700,this._health=700,this.on("spawn",(()=>{this.spawnEnemiesTask(e),this.throwBombsTask(e),this.rebuildWallTask(e)}))}async spawnEnemiesTask(e){for(;this.isAlive&&!e.isDestroyed;){const t=new Ne(e,{runAwayFromPlayer:!1});t.spawnAt(e.board.getRandomNonWallCell()),e.addActors(t);const i=new ye(e);i.spawnAt(e.board.getRandomNonWallCell()),e.addActors(i);const r=new He(e);r.spawnAt(e.board.getRandomNonWallCell()),e.addActors(r),await le(3e4)}}async throwBombsTask(e){for(await le(5e3);this.isAlive&&!e.isDestroyed;){await le(3e3);for(let t=0;t<3;t++)We({context:e,src:this.nearestCell,dest:e.player.nearestCell}),await le(500)}}async rebuildWallTask(e){for(;this.isAlive&&!e.isDestroyed;){await le(2e4),new Se(e,{delay:0}).spawnAt(this.nearestCell,this);for(let t=0;t<3;t++)e.board.getCellAt(5-t,7).block=new Me(e),e.board.getCellAt(9+t,7).block=new Me(e),e.board.getCellAt(7,5-t).block=new Me(e),e.board.getCellAt(7,9+t).block=new Me(e),await le(500);for(let t=0;t<3;t++)e.board.getCellAt(6+t,1).block=new Me(e),e.board.getCellAt(1,6+t).block=new Me(e),e.board.getCellAt(6+t,13).block=new Me(e),e.board.getCellAt(13,6+t).block=new Me(e)}}}class Ie{getName(){return"Level 4 [BOSS]"}async load(e){this.initBoard(e),e.resize(),"loaded"!=e.epicMusic.state()&&await new Promise((t=>{e.epicMusic.once("load",(()=>{t()}))}))}start(e){e.player.spawnAt(1,1),e.epicMusic.play(),(async()=>{const t=e.board.getCellAt(7,7),i=new Q(e.cellSize);e.addObject(i),t.alignObject(i),await le(19150),i.destroy();const r=new Xe(e);r.spawnAt(t),e.addActors(r);const s=new Se(e,{delay:0}),l=new _e(e,{delay:0,radius:7,propagationDelay:100,destroyBricks:!1});for(s.spawnAt(t,null),l.spawnAt(t,null);!e.isDestroyed;){await le(5e3);const t=e.board.getRandomNonWallCell(),i=je.getRandom(e);t.block=i}})()}initBoard(e){const t=new Te(e);t.fillRectangle(0,0,14,14,"wall"),t.fillRectangle(1,1,13,13,"grass"),t.fillRectangle(5,5,9,9,"wall"),t.fillRectangle(6,6,8,8,"grass"),t.fillRectangle(4,4,5,5,"bricks"),t.fillRectangle(9,9,10,10,"bricks"),t.fillRectangle(4,9,5,10,"bricks"),t.fillRectangle(9,4,10,5,"bricks"),t.fillHorizontalLine(7,3,6,"bricks"),t.fillHorizontalLine(7,8,11,"bricks"),t.fillVerticalLine(7,3,6,"bricks"),t.fillVerticalLine(7,8,11,"bricks"),t.fillRectangle(2,2,4,4,"wall"),t.fillVerticalLine(3,2,3,"grass"),t.fillHorizontalLine(3,2,3,"grass"),t.fillRectangle(4,4,2,2,"wall"),t.fillRectangle(2,2,3,3,"grass"),t.fillCell(2,2,"wall"),t.fillRectangle(10,10,12,12,"wall"),t.fillRectangle(11,11,12,12,"grass"),t.fillCell(12,12,"wall"),t.fillRectangle(10,4,12,2,"wall"),t.fillRectangle(11,3,12,2,"grass"),t.fillCell(12,2,"wall"),t.fillRectangle(4,10,2,12,"wall"),t.fillRectangle(3,11,2,12,"grass"),t.fillCell(2,12,"wall"),t.fillVerticalLine(1,6,8,"bricks"),t.fillVerticalLine(13,6,8,"bricks"),t.fillHorizontalLine(1,6,8,"bricks"),t.fillHorizontalLine(13,6,8,"bricks"),t.build()}}class Ve{constructor(){Object.defineProperty(this,"dom",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.dom=document.createElement("div"),this.dom.classList.add("overlay")}showPlay(e){const t=document.createElement("div");t.classList.add("play-button"),t.append("Play"),t.addEventListener("click",e),this.dom.replaceChildren(t)}showTryAgain(e){const t=document.createElement("div");t.classList.add("orange-title"),t.append("GAME OVER!");const i=document.createElement("div");i.classList.add("play-button"),i.append("Try again"),i.addEventListener("click",e),this.dom.replaceChildren(t,i)}showPlayAgain(e){const t=document.createElement("div");t.classList.add("orange-title"),t.append("YOU WIN!");const i=document.createElement("div");i.classList.add("play-button"),i.append("Play again"),i.addEventListener("click",e),this.dom.replaceChildren(t,i)}}class Ke{constructor(e){Object.defineProperty(this,"level",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dom",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.level=e,this.dom=document.createElement("div"),this.dom.append(e.getName()),this.dom.classList.add("menu-item")}set isActive(e){e?this.dom.classList.add("active"):this.dom.classList.remove("active")}}(async()=>{const e=new me;await e.initialize();const t=document.getElementById("root"),i=document.getElementById("menu"),r=new Ve,s=[new De,new Fe,new Ue,new Ie],l=[],a=async(i,s=!1)=>{const l=e.createContext();await i.load(l),s?(i.start(l),r.dom.remove()):(t.append(r.dom),r.showPlay((async()=>{i.start(l),r.dom.remove()}))),l.on("win",(()=>{l.isDestroyed||(l.destroy(),t.append(r.dom),r.showPlayAgain((()=>a(i,!0))))})),l.on("lose",(()=>{l.isDestroyed||(l.destroy(),t.append(r.dom),r.showTryAgain((()=>a(i,!0))))}))};s.forEach((e=>{const t=new Ke(e);t.dom.addEventListener("click",(async()=>{l.forEach((e=>e.isActive=!1)),t.isActive=!0,a(t.level)})),i.append(t.dom),l.push(t)})),l[0].dom.click()})()}},i={};function r(e){var s=i[e];if(void 0!==s)return s.exports;var l=i[e]={id:e,loaded:!1,exports:{}};return t[e].call(l.exports,l,l.exports,r),l.loaded=!0,l.exports}r.m=t,e=[],r.O=(t,i,s,l)=>{if(!i){var a=1/0;for(h=0;h<e.length;h++){for(var[i,s,l]=e[h],o=!0,n=0;n<i.length;n++)(!1&l||a>=l)&&Object.keys(r.O).every((e=>r.O[e](i[n])))?i.splice(n--,1):(o=!1,l<a&&(a=l));if(o){e.splice(h--,1);var c=s();void 0!==c&&(t=c)}}return t}l=l||0;for(var h=e.length;h>0&&e[h-1][2]>l;h--)e[h]=e[h-1];e[h]=[i,s,l]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),r.p="./",(()=>{var e={179:0};r.O.j=t=>0===e[t];var t=(t,i)=>{var s,l,[a,o,n]=i,c=0;if(a.some((t=>0!==e[t]))){for(s in o)r.o(o,s)&&(r.m[s]=o[s]);if(n)var h=n(r)}for(t&&t(i);c<a.length;c++)l=a[c],r.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return r.O(h)},i=globalThis.webpackChunkbomberman=globalThis.webpackChunkbomberman||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var s=r.O(void 0,[195],(()=>r(622)));s=r.O(s)})();